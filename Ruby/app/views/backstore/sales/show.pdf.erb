<div style="font-family: Arial, sans-serif; padding: 20px;">
  <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 20px;">
    <h1 style="margin: 0; font-size: 24px; color: #000;">FACTURA DE VENTA</h1>
    <p style="margin: 5px 0; font-size: 14px;">Venta #<%= @sale.id %></p>
  </div>

  <div style="margin-bottom: 30px;">
    <h2 style="font-size: 18px; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">Informacion del Cliente</h2>
    <table style="width: 100%; border-collapse: collapse;">
      <tr>
        <td style="padding: 8px; border: 1px solid #000; width: 30%; font-weight: bold;">Nombre:</td>
        <td style="padding: 8px; border: 1px solid #000;"><%= @sale.client_name %></td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #000; font-weight: bold;">Email:</td>
        <td style="padding: 8px; border: 1px solid #000;"><%= @sale.client_email %></td>
      </tr>
    </table>
  </div>

  <div style="margin-bottom: 30px;">
    <h2 style="font-size: 18px; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">Informacion del Empleado</h2>
    <table style="width: 100%; border-collapse: collapse;">
      <tr>
        <td style="padding: 8px; border: 1px solid #000; width: 30%; font-weight: bold;">Nombre:</td>
        <td style="padding: 8px; border: 1px solid #000;"><%= @sale.employee_name %></td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #000; font-weight: bold;">Email:</td>
        <td style="padding: 8px; border: 1px solid #000;"><%= @sale.employee_email %></td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #000; font-weight: bold;">Fecha de venta:</td>
        <td style="padding: 8px; border: 1px solid #000;"><%= l(@sale.created_at, format: :long) %></td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #000; font-weight: bold;">Estado:</td>
        <td style="padding: 8px; border: 1px solid #000;">
          <% if @sale.cancelled_at? %>
            Cancelada (<%= @sale.cancelled_at&.strftime("%d/%m/%Y") %>)
          <% else %>
            Activa
          <% end %>
        </td>
      </tr>
      <% if @sale.cancelled_at? %>
        <tr>
          <td style="padding: 8px; border: 1px solid #000; font-weight: bold;">Fecha de cancelacion:</td>
          <td style="padding: 8px; border: 1px solid #000;"><%= l(@sale.cancelled_at, format: :long) %></td>
        </tr>
      <% end %>
    </table>
  </div>

  <div style="margin-bottom: 30px;">
    <h2 style="font-size: 18px; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">Productos Vendidos</h2>
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="background-color: #000; color: #fff;">
          <th style="padding: 10px; border: 1px solid #000; text-align: left;">Producto</th>
          <th style="padding: 10px; border: 1px solid #000; text-align: center; width: 80px;">Cantidad</th>
          <th style="padding: 10px; border: 1px solid #000; text-align: right; width: 120px;">Precio Unitario</th>
          <th style="padding: 10px; border: 1px solid #000; text-align: right; width: 120px;">Subtotal</th>
        </tr>
      </thead>
      <tbody>
        <% @sale.sale_items.each do |item| %>
          <tr>
            <td style="padding: 8px; border: 1px solid #000;">
              <strong><%= item.product.name %></strong><br>
              <span style="font-size: 11px; color: #666;">Autor: <%= item.product.author %></span>
            </td>
            <td style="padding: 8px; border: 1px solid #000; text-align: center;"><%= item.quantity %></td>
            <td style="padding: 8px; border: 1px solid #000; text-align: right;">$ <%= number_with_precision(item.unit_price, precision: 2) %></td>
            <td style="padding: 8px; border: 1px solid #000; text-align: right; font-weight: bold;">$ <%= number_with_precision(item.subtotal, precision: 2) %></td>
          </tr>
        <% end %>
      </tbody>
      <tfoot>
        <tr style="background-color: #f0f0f0; font-weight: bold;">
          <td colspan="3" style="padding: 10px; border: 1px solid #000; text-align: right;">TOTAL:</td>
          <td style="padding: 10px; border: 1px solid #000; text-align: right; font-size: 16px;">$ <%= number_with_precision(@sale.total_amount, precision: 2) %></td>
        </tr>
      </tfoot>
    </table>
  </div>

  <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #000;">
    <table style="width: 100%;">
      <tr>
        <td style="width: 50%;">
          <strong>Total de productos:</strong> <%= @sale.total_items %>
        </td>
        <td style="width: 50%; text-align: right;">
          <strong>Total de la venta:</strong> $ <%= number_with_precision(@sale.total_amount, precision: 2) %>
        </td>
      </tr>
    </table>
  </div>
</div>
