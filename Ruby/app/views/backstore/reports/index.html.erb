<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="mb-0">Reportes de ventas</h1>
  <div class="d-flex gap-2">
    <%= link_to "Exportar PDF", backstore_reports_export_pdf_path(request.query_parameters),
                class: "btn btn-outline-dark", target: "_blank" %>
  </div>
</div>

<%= render "filters" %>

<% if (@total_sales.to_i + @total_cancelled.to_i).zero? %>
  <div class="card shadow-sm p-4 mb-4">
    <p class="mb-0">
      No se encontraron ventas para los filtros seleccionados.
      Probá ampliar el rango de fechas o quitar algún filtro.
    </p>
  </div>
<% end %>

<div class="row g-4">
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h2 class="h6 mb-2">Total recaudado (ventas activas)</h2>
      <p class="h4 mb-0">$ <%= number_with_precision(@total_revenue || 0, precision: 2) %></p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h2 class="h6 mb-2">Ventas activas</h2>
      <p class="h4 mb-0"><%= @total_sales || 0 %></p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h2 class="h6 mb-2">Productos vendidos (ventas activas)</h2>
      <p class="h4 mb-0"><%= @total_items || 0 %></p>
    </div>
  </div>
</div>

<div class="row g-4 mt-1">
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h2 class="h6 mb-2">Monto perdido por cancelaciones</h2>
      <p class="h4 mb-0">$ <%= number_with_precision(@lost_revenue || 0, precision: 2) %></p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h2 class="h6 mb-2">Ventas canceladas</h2>
      <p class="h4 mb-0"><%= @total_cancelled || 0 %></p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h2 class="h6 mb-2">Productos en ventas canceladas</h2>
      <p class="h4 mb-0"><%= @total_cancelled_items || 0 %></p>
    </div>
  </div>
</div>

<div class="card shadow-sm p-4 mt-4">
  <h2 class="h5 mb-3">Reportes disponibles</h2>
  <ul class="mb-0">
    <li>
      <%= link_to "Ventas en el tiempo", backstore_reports_sales_over_time_path(request.query_parameters) %>
    </li>
    <li>
      <%= link_to "Ventas por producto", backstore_reports_sales_by_product_path(request.query_parameters) %>
    </li>
    <li>
      <%= link_to "Ventas por empleado", backstore_reports_sales_by_employee_path(request.query_parameters) %>
    </li>
  </ul>
</div>


